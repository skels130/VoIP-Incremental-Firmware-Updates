<Directory "/var/www/html/yealink">
RewriteEngine on
RewriteBase "/yealink"
############################ Yealink ################################

############## T21P E2 ##############
### 84.0.125 ###
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T21P_E2 (52)\.84\.0\.125.*"
RewriteRule "^52.rom$" "52\.84\.0\.160\.rom" [L]
############## T31/T30/T30P/T31G/T31P/T33P/T33G ##############
### 86.0.40 ###
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T3[013][GP]? 124\.86\.0\.40.*"
RewriteRule "^124.rom$" "124.86\.0\.75\.rom" [L]
### 86.0.75 ###
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T3[013][GP]? 124\.86\.0\.75.*"
RewriteRule "^124.rom$" "124.87\.0\.15\.rom" [L]

############## T4XG ##############
### 73.0.40 ###
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T4[01268]G (\d{2})\.73\.0\.40.*"
RewriteRule "^\d{2}.rom$" "%1\.80\.0\.60\.rom" [L]
### 73.0.50 ###
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T4[01268]G (\d{2})\.73\.0\.50.*"
RewriteRule "^(\d{2}).rom$" "%1\.80\.0\.60\.rom" [L]
### 80.0.60 ###
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T4[01268]G (\d{2})\.80\.0\.60.*"
RewriteRule "^(\d{2}).rom$" "%1\.80\.0\.95\.rom" [L]
### 80.0.70 ###
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T4[01268]G (\d{2})\.80\.0\.70.*"
RewriteRule "^(\d{2}).rom$" "%1\.80\.0\.95\.rom" [L]
### 80.0.95 ###
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T4[01268]G (\d{2})\.80\.0\.95.*"
RewriteRule "^(\d{2}).rom$" "%1\.80\.0\.125\.rom" [L]
### 80.0.125 ###
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T4[01268]G (\d{2})\.80\.0\.125.*"
RewriteRule "^(\d{2}).rom$" "%1\.80\.0\.130\.rom" [L]
### 80.0.130 ###
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T4[01268]G (\d{2})\.80\.0\.130.*"
RewriteRule "^(\d{2}).rom$" "%1\.81\.0\.25\.rom" [L]
### 80.0.162 ###
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T4[01268]G (\d{2})\.80\.0\.162.*"
RewriteRule "^(\d{2}).rom$" "%1\.81\.0\.25\.rom" [L]
### 81.0.25 ###
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T4[01268]G (\d{2})\.81\.0\.25.*"
RewriteRule "^(\d{2}).rom$" "%1\.81\.0\.60\.rom" [L]
### 81.0.60 T42GT/T48G ###
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T4[28]G (\d{2})\.81\.0\.60.*"
RewriteRule "^(\d{2}).rom$" "%1\.81\.0\.70\.rom" [L]
### 81.0.70 T42G/T48G ###
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T4[28]G (\d{2})\.81\.0\.70.*"
RewriteRule "^(\d{2}).rom$" "%1\.81\.0\.110\.rom" [L]
### 81.0.60 ###
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T4[016]G (\d{2})\.81\.0\.60.*"
RewriteRule "^(\d{2}).rom$" "%1\.81\.0\.110\.rom" [L]
### 81.0.110 ###
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T4[01268]G (\d{2})\.81\.0\.110.*"
RewriteRule "^(\d{2}).rom$" "%1\.82\.0\.20\.rom" [L]
### 82.0.20 T42G ###
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T42G (\d{2})\.82\.0\.20.*"
RewriteRule "^(\d{2}).rom$" "%1\.83\.0\.120\.rom" [L]
### 82.0.20 ###
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T4[0168]G (\d{2})\.82\.0\.20.*"
RewriteRule "^(\d{2}).rom$" "%1\.82\.0\.30\.rom" [L]
### 83.0.30 ###
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T4[01268]G (\d{2})\.83\.0\.30.*"
RewriteRule "^(\d{2}).rom$" "%1\.83\.0\.120\.rom" [L]
### 83.0.55 ###
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T4[01268]G (\d{2})\.83\.0\.55.*"
RewriteRule "^(\d{2}).rom$" "%1\.83\.0\.120\.rom" [L]
### 83.0.65 ###
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T4[01268]G (\d{2})\.83\.0\.65.*"
RewriteRule "^(\d{2}).rom$" "%1\.83\.0\.120\.rom" [L]
### 83.0.120 ###
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T4[01268]G (\d{2})\.83\.0\.120.*"
RewriteRule "^(\d{2}).rom$" "%1\.83\.0\.160\.rom" [L]

############## T40G/P above 84 ##############
### 84.0.90 ###
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T40[GP] (\d{2})\.84\.0\.90.*"
RewriteRule "^(\d{2}).rom$" "%1\.84\.0\.125\.rom" [L]
### 84.0.125 ###
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T40[GP] (\d{2})\.84\.0\.125.*"
RewriteRule "^(\d{2}).rom$" "%1\.84\.0\.160\.rom" [L]



############## T41S/T42S/T46S/T48S ##############
### 81.X.X ###
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T4[1268]S (6[5-8])\.81.*"
RewriteRule "^(\d{2}).rom$" "%1\.83\.0\.35\.rom" [L]
### 83.0.35 ###
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T4[1268]S (6[5-8])\.83\.0\.35.*"
RewriteRule "^(\d{2}).rom$" "%1\.84\.0\.10\.rom" [L]
### 83.0.120 ###
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T4[1268]S (6[5-8])\.83\.0\.120.*"
RewriteRule "^(\d{2}).rom$" "%1.84.0.10.rom" [L]
### 84.0.125 ###
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T4[1268]S (6[5-8])\.84.*"
RewriteRule "^(\d{2}).rom$" "%1.86.0.15.rom" [L]
### 85 ###
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T4[1268]S (6[5-8])\.85.*"
RewriteRule "^(\d{2}).rom$" "%1.86.0.15.rom" [L]

### Latest 86 ###
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T4[1268]S (6[5-8])\.86.*"
RewriteRule "^(\d{2}).rom$" "%1.86.0.160.rom" [L]


############## T46U/T43U/T46U/T41U/T48U/T42U/T44U/T44W ##############
### 84 ###
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T4[123468][UW] (108)\.84.*"
RewriteRule "^(108).rom$" "%1.85.0.39.rom" [L]
### 85 ###
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T4[123468][UW] (108)\.85.*"
RewriteRule "^(108).rom$" "%1.86.0.70.rom" [L]
### 86 Below 86.0.70 ###
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T4[123468][UW] (108)\.86\.0\.[1-6]\d .*"
RewriteRule "^(108).rom$" "%1.86.0.70.rom" [L]
### 86.0.7X ###
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T4[123468][UW] (108)\.86\.0\.7\d.*"
RewriteRule "^(108).rom$" "%1.86.0.90.rom" [L]
### 86.0.90 ###
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T4[123468][UW] (108)\.86\.0\.90.*"
RewriteRule "^(108).rom$" "%1.87.0.15.rom" [L]
### 86 Above 86.0.90 ###
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T4[123468][UW] (108)\.86\.0\.\d{3}.*"
RewriteRule "^(108).rom$" "%1.87.0.15.rom" [L]
### 86.25.xx ###
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T4[123468][UW] (108)\.86\.25\..*"
RewriteRule "^(108).rom$" "%1.87.0.15.rom" [L]
### Latest 87 ###
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T4[123468][UW] (108)\.87\..*"
RewriteRule "^(108).rom$" "%1.87.0.15.rom" [L]

############## T54S/T52S ##############
### 83 ###
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T5[24]S (70)\.83.*"
RewriteRule "^(70).rom$" "%1.84.0.160.rom" [L]
### 84 ###
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T5[24]S (70)\.84.*"
RewriteRule "^(70).rom$" "%1.84.0.160.rom" [L]

############## T54W/T57W/T53W/T53 ##############
### 84 ###
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T5[347]W? (96)\.84.*"
RewriteRule "^(96).rom$" "%1.86.0.18.rom" [L]
### 85 ###
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T5[347]W? (96)\.85.*"
RewriteRule "^(96).rom$" "%1.86.0.18.rom" [L]
### 86 Below 86.0.70 ###
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T5[347]W? (96)\.86\.0\.[1-6]\d .*"
RewriteRule "^(96).rom$" "%1.86.0.70.rom" [L]
### 86.0.7X ###
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T5[347]W? (96)\.86\.0\.7\d.*"
RewriteRule "^(96).rom$" "%1.87.0.15.rom" [L]
### 86 Above 86.0.70 ###
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T5[347]W? (96)\.86\.0\.\d{3}.*"
RewriteRule "^(96).rom$" "%1.87.0.15.rom" [L]
### Latest 87 ###
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T5[347]W? (96)\.87\.0\..*"
RewriteRule "^(96).rom$" "%1.87.0.15.rom" [L]

############## W53H ##############
#upgrades handset to same or next lowest firmware version
### 83.0.10 Handset ###
RewriteCond "%{REQUEST_FILENAME}" "88\.rom"
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink W[67]0B (\d{2})\.83\.0\.[1-4]\d.*"
RewriteRule "^(88).rom$" "%1.83.0.10.rom" [L]
### 83.0.50-89 Handset ###
RewriteCond "%{REQUEST_FILENAME}" "88\.rom"
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink W[67]0B (\d{2})\.83\.0\.[5-8]\d.*"
RewriteRule "^(88).rom$" "%1.83.0.50.rom" [L]
### 83.0.90 Handset ###
RewriteCond "%{REQUEST_FILENAME}" "88\.rom"
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink W[67]0B (\d{2})\.83\.0\.9\d.*"
RewriteRule "^(88).rom$" "%1.83.0.90.rom" [L]
### 84 Handset ###
RewriteCond "%{REQUEST_FILENAME}" "88\.rom"
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink W[67]0B (\d{2})\.84\..*"
RewriteRule "^(88).rom$" "%1.83.0.90.rom" [L]
### 85.0.20 Handset ###
RewriteCond "%{REQUEST_FILENAME}" "88\.rom"
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink W[67]0B (\d{2})\.85\.0\.[2-9]\d.*"
RewriteRule "^(88).rom$" "%1.85.0.20.rom" [L]
RewriteCond "%{REQUEST_FILENAME}" "88\.rom"
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink W[67]0B (\d{2})\.85\.0\.160.*"
RewriteRule "^(88).rom$" "%1.85.0.20.rom" [L]

############## W60B ##############
### Under 83.0.85 ###
RewriteCond "%{REQUEST_FILENAME}" "77\.rom"
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink W60B (77)\.83\.0\.[1-7]\d.*"
RewriteRule "^(77).rom$" "$1.83.0.85.rom" [L]

### 83.0.85 ###
RewriteCond "%{REQUEST_FILENAME}" "77\.rom"
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink W60B (77)\.83\.0\.85.*"
RewriteRule "^(77).rom$" "$1.85.0.25.rom" [L]

### 85.0.25 ###
RewriteCond "%{REQUEST_FILENAME}" "77\.rom"
RewriteCond "%{HTTP_USER_AGENT}" "^Yealink W60B (77)\.85\.0\.25.*"
RewriteRule "^(77).rom$" "$1.85.0.160.rom" [L]

############## W70B ##############


</Directory>


#Unused steps: 
### 80.0.70 ###
# RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T4[01268]G (\d{2})\.80\.0\.70.*"
# RewriteRule "^(\d{2}).rom$" "%1\.80\.0\.95\.rom" [L]
### 80.0.80 ###
# RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T4[01268]G (\d{2})\.80\.0\.80.*"
# RewriteRule "^(\d{2}).rom$" "%1\.80\.0\.90\.rom" [L]
### 80.0.90 ###
# RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T4[01268]G (\d{2})\.80\.0\.90.*"
# RewriteRule "^(\d{2}).rom$" "%1\.80\.0\.95\.rom" [L]

### 82.0.30 ###
#RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T4[01268]G (\d{2})\.82\.0\.30.*"
#RewriteRule "^(\d{2}).rom$" "%1\.83\.0\.10\.rom" [L]
### 83.0.10 ###
#RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T4[01268]G (\d{2})\.83\.0\.10.*"
#RewriteRule "^(\d{2}).rom$" "%1\.83\.0\.30\.rom" [L]
### 83.0.30 ###
#RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T4[01268]G (\d{2})\.83\.0\.30.*"
#RewriteRule "^(\d{2}).rom$" "%1\.83\.0\.35\.rom" [L]
### 83.0.35 ###
#RewriteCond "%{HTTP_USER_AGENT}" "^Yealink SIP-T4[01268]G (\d{2})\.83\.0\.35.*"
#RewriteRule "^(\d{2}).rom$" "%1\.83\.0\.50\.rom" [L]
